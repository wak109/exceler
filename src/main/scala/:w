/* vim: set ts=2 et sw=2 sts=2 fileencoding=utf-8: */
import scala.collection._
import scala.language.implicitConversions
import scala.util.control.Exception._
import scala.util.{Try, Success, Failure}

import org.apache.poi.ss.usermodel._
import org.apache.poi.xssf.usermodel.XSSFWorkbook


trait ExcelRectangle {
  val sheet:Sheet
  val top:Int
  val left:Int
  val bottom:Int
  val right:Int

  def row(row:Int):ExcelRow = {
    assert((0 <= row) && (row < right - left))
    for (column <- Range(left, right)) yield sheet.cell(row, column)
  }

  def column(column:Int):ExcelRow = {
    assert((0 <= column) && (column < bottom - top))
    for (column <- Range(bottom, right)) yield sheet.cell(row, column)
  }
}


object ExcelRectangle {

  def apply(sheet:Sheet, top:Int, left:Int, bottom:Int, right:Int) = {

    class Impl (
      val sheet:Sheet,
      val top:Int,
      val left:Int,
      val bottom:Int,
      val right:Int
    ) extends ExcelRectangle

    new Impl(sheet, top, left, bottom, right)
  }
}

